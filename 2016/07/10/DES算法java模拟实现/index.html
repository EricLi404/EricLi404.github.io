<!DOCTYPE html>
<html lang="">
  <head>
    
<meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width,user-scalable=no,initial-scale=1,minimum-scale=1,maximum-scale=1">


<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />



  <meta name="description" content="本文记录了笔者大二下学期应用密码学课程设计所做内容。"/>




  <meta name="keywords" content="Java,code," />





  <link rel="alternate" href="/atom.xml" title="DropLet">




  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=1.1" />



<link rel="canonical" href="http://ericli.top/2016/07/10/DES算法java模拟实现/"/>


<meta name="description" content="本文记录了笔者大二下学期应用密码学课程设计所做内容。">
<meta name="keywords" content="Java,code">
<meta property="og:type" content="article">
<meta property="og:title" content="DES算法Java模拟实现">
<meta property="og:url" content="http://ericli.top/2016/07/10/DES算法java模拟实现/index.html">
<meta property="og:site_name" content="DropLet">
<meta property="og:description" content="本文记录了笔者大二下学期应用密码学课程设计所做内容。">
<meta property="og:updated_time" content="2020-02-19T09:49:02.439Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="DES算法Java模拟实现">
<meta name="twitter:description" content="本文记录了笔者大二下学期应用密码学课程设计所做内容。">


<link rel="stylesheet" type="text/css" href="/css/style.css?v=1.1" />
<link href='https://fonts.googleapis.com/css?family=Open+Sans' rel='stylesheet'>





<script type="text/javascript">
  var themeConfig = {
    fancybox: {
      enable: false
    },
  };
</script>




  



    <title> DES算法Java模拟实现 - DropLet </title>
  </head>

  <body>
    <div id="page">
      <header id="masthead"><div class="site-header-inner">
    <h1 class="site-title">
        <a href="/." class="logo">DropLet</a>
    </h1>

    <nav id="nav-top">
        
            <ul id="menu-top" class="nav-top-items">
                
                    <li class="menu-item">
                        <a href="/archives">
                            
                            
                                Archives
                            
                        </a>
                    </li>
                
                    <li class="menu-item">
                        <a href="/about">
                            
                            
                                About
                            
                        </a>
                    </li>
                
            </ul>
        
  </nav>
</div>

      </header>
      <div id="content">
        
    <div id="primary">
        
  <article class="post">
    <header class="post-header">
      <h1 class="post-title">
        
          DES算法Java模拟实现
        
      </h1>

      <time class="post-time">
          Jul 10 2016
      </time>
    </header>



    
            <div class="post-content">
            <blockquote>
<p>大二下学期应用密码学课程设计</p>
</blockquote>
<h1 id="已同步github项目："><a href="#已同步github项目：" class="headerlink" title="已同步github项目："></a>已同步github项目：</h1><p>url:<a href="https://github.com/EricLi404/Java-Demos/tree/master/Des-Demo" target="_blank" rel="noopener">https://github.com/EricLi404/Java-Demos/tree/master/Des-Demo</a></p>
<p>git:<a href="https://github.com/EricLi404/Java-Demos.git" target="_blank" rel="noopener">https://github.com/EricLi404/Java-Demos.git</a></p>
<p>实现了des算法，具体的每一步的输出都有记录，没有加入工作模式，支持加密的输入为英文和数字混合的字符串，填充方式采用的无限填充0的做法。下面是源码。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">// 主类，含有一些调试信息，各种输出</span><br><span class="line"></span><br><span class="line">package cryptology;</span><br><span class="line"></span><br><span class="line">import java.util.Scanner;</span><br><span class="line"></span><br><span class="line">/**</span><br><span class="line"> * Created by leif on 2016/3/26 0026.</span><br><span class="line"> */</span><br><span class="line">public class des &#123;</span><br><span class="line">	public static void main(String[] args) &#123;</span><br><span class="line">        System.out.println(&quot;**********************************************************&quot;);</span><br><span class="line">        System.out.println(&quot;                      DES加解密分步演示                      &quot;);</span><br><span class="line">        System.out.println(&quot;**********************************************************&quot;);</span><br><span class="line">        System.out.println();</span><br><span class="line">        @SuppressWarnings(&quot;resource&quot;)</span><br><span class="line">		Scanner in = new Scanner(System.in);</span><br><span class="line">        System.out.print(&quot;请输入明文(支持任意长度字母数字组合)：&quot;);</span><br><span class="line">        String mmmmmm = in.nextLine();</span><br><span class="line">        System.out.print(&quot;请输入密钥(支持任意格式输入)：&quot;);</span><br><span class="line">        String kkkkkk = in.nextLine();</span><br><span class="line">        String[] M = util.all2string(mmmmmm);</span><br><span class="line">        char[] K = util.keypre(kkkkkk);</span><br><span class="line">        descore descore = new descore();</span><br><span class="line">        String mimi = descore.en(M, K);</span><br><span class="line">        String demimi = descore.de(util.all222string(mimi), K);</span><br><span class="line">        String demimistring = util.byte2string(demimi);</span><br><span class="line">        System.out.println(&quot;*************************************************&quot;);</span><br><span class="line">        System.out.println(&quot;**********************结果***********************&quot;);</span><br><span class="line">        System.out.println(&quot;明文：&quot;+mmmmmm);</span><br><span class="line">        System.out.println(&quot;------------------------------------------------------------&quot;);</span><br><span class="line">        System.out.println(&quot;加密结果：&quot;);</span><br><span class="line">        System.out.println(&quot;二进制：&quot;+ mimi);</span><br><span class="line">        System.out.println(&quot;十六进制：&quot;+util.two2hex(mimi));</span><br><span class="line">        System.out.println(&quot;------------------------------------------------------------&quot;);</span><br><span class="line">        System.out.println(&quot;解密结果：&quot;);</span><br><span class="line">        System.out.println(&quot;二进制：&quot;+demimi);</span><br><span class="line">        System.out.println(&quot;十六进制：&quot;+util.two2hex(demimi));</span><br><span class="line">        System.out.println(&quot;编码后：&quot;+demimistring);</span><br><span class="line">            </span><br><span class="line">        </span><br><span class="line">     </span><br><span class="line">		</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br></pre></td><td class="code"><pre><span class="line">// 核心算法类</span><br><span class="line">package cryptology;</span><br><span class="line"></span><br><span class="line">/**</span><br><span class="line"> * Created by leif on 2016/3/26 0026.</span><br><span class="line"> */</span><br><span class="line">public class descore &#123;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * 初始置換</span><br><span class="line">     * @param M char[64]</span><br><span class="line">     * @return char[56]</span><br><span class="line">     */</span><br><span class="line">    private char[] initReplace(char[] M)&#123;</span><br><span class="line">        char[] tM = new char[64];</span><br><span class="line">        for (int i = 0; i &lt; 64; i++)&#123;</span><br><span class="line">            tM[i] = M[data.IP[i]-1];</span><br><span class="line">        &#125;</span><br><span class="line">        return tM;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * 密钥置换 1</span><br><span class="line">     * @param K char[64]</span><br><span class="line">     * @return char[56]</span><br><span class="line">     */</span><br><span class="line">    private char[] keyReplace1(char[] K)&#123;</span><br><span class="line">        char[] tK = new char[64];</span><br><span class="line">        for (int i = 0; i &lt; 56; i++)&#123;</span><br><span class="line">            tK[i] = K[data.PC_1[i]-1];</span><br><span class="line">        &#125;</span><br><span class="line">        return tK;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * 生成子密钥</span><br><span class="line">     * @param K char[56]</span><br><span class="line">     * @param offset 左移位数 int</span><br><span class="line">     * @return char[56]</span><br><span class="line">     */</span><br><span class="line">    private char[] loopKey(char[] K, int offset)&#123;</span><br><span class="line">        String k1 = new String();</span><br><span class="line">        String k2 = new String();</span><br><span class="line">        String k = new String(K);</span><br><span class="line">        k1 = (k.substring(0,28)+k.substring(0,2)).substring(offset,offset+28);</span><br><span class="line">        k2 = (k.substring(28,56)+k.substring(28,30)).substring(offset,offset+28);</span><br><span class="line">        return (k1+k2).toCharArray();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     *  密钥置换2</span><br><span class="line">     * @param K char[56]</span><br><span class="line">     * @return char[48]</span><br><span class="line">     */</span><br><span class="line">    private char[] keyReplace2(char[] K)&#123;</span><br><span class="line">        char[] tK = new char[48];</span><br><span class="line">        for (int i = 0; i &lt; 48; i++)&#123;</span><br><span class="line">            tK[i] = K[data.PC_2[i]-1];</span><br><span class="line">        &#125;</span><br><span class="line">        return tK;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     *  生成16轮的轮密钥</span><br><span class="line">     * @param K char[64]</span><br><span class="line">     * @return</span><br><span class="line">     */</span><br><span class="line">    private char[][] getKey(char[] K)&#123;</span><br><span class="line">        char[][] tK = new char[16][48];</span><br><span class="line">        char[][] ttK = new char[16][48];</span><br><span class="line">        char[] k1 = new char[56];</span><br><span class="line">        k1 = keyReplace1(K);</span><br><span class="line">        tK[0] = loopKey(k1,data.LeftMove[0]);</span><br><span class="line">        for (int i = 1; i &lt; 16; i++)&#123;</span><br><span class="line">            tK[i] = loopKey(tK[i-1],data.LeftMove[i]);</span><br><span class="line">        &#125;</span><br><span class="line">        for(int i = 0; i &lt; 16; i++)&#123;</span><br><span class="line">        	ttK[i] = keyReplace2(tK[i]);</span><br><span class="line">        &#125;</span><br><span class="line">        return ttK;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * E 表置换（拓展置换）</span><br><span class="line">     * @param R char[32]</span><br><span class="line">     * @return char[48]</span><br><span class="line">     */</span><br><span class="line">    private char[] eReplace(char[] R)&#123;</span><br><span class="line">        char[] tR = new char[48];</span><br><span class="line">        for (int i = 0;i &lt; 48; i++)&#123;</span><br><span class="line">            tR[i] = R[data.E[i]-1];</span><br><span class="line">        &#125;</span><br><span class="line">        return tR;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     *  xor异或操作</span><br><span class="line">     * @param tR char[48]</span><br><span class="line">     * @param K char[48] 轮密钥</span><br><span class="line">     * @return</span><br><span class="line">     */</span><br><span class="line">    private char[] xor(char[] tR, char[] K)&#123;</span><br><span class="line">        String x = new String();</span><br><span class="line">        for (int i = 0; i &lt; tR.length; i++)&#123;</span><br><span class="line">            x += tR[i] ^ K[i];</span><br><span class="line">        &#125;</span><br><span class="line">        return x.toCharArray();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * s 盒置换</span><br><span class="line">     * @param xorR char[48]</span><br><span class="line">     * @return char[32]</span><br><span class="line">     */</span><br><span class="line">    private char[] sReplace(char[] xorR)&#123;</span><br><span class="line">        char[][] tR = new char[8][6];</span><br><span class="line">/*        String  nn = new String(R);</span><br><span class="line">        System.out.println(nn+nn.length());*/</span><br><span class="line">        String sr = new String();</span><br><span class="line">        for (int i = 0; i &lt; 8; i++)&#123;</span><br><span class="line">            for (int j = 0; j &lt; 6; j++)&#123;</span><br><span class="line">                tR[i][j] = xorR[i*6+j];</span><br><span class="line">            &#125;</span><br><span class="line">            int p = util.two2ten(String.valueOf(tR[i][0])+String.valueOf(tR[i][5]));</span><br><span class="line">            int q = util.two2ten(String.valueOf(tR[i][1])+String.valueOf(tR[i][2])+String.valueOf(tR[i][3])+String.valueOf(tR[i][4]));</span><br><span class="line">             sr += String.format(&quot;%04d&quot;,Integer.parseInt(Integer.toBinaryString(data.S_Box[i][p][q])));</span><br><span class="line">//            sr += String.format(&quot;%04d&quot;,Integer.parseInt(Integer.toBinaryString(data.S_Box[i][(tR[i][0] &lt;&lt; 1) + tR[i][5]][(tR[i][1] &lt;&lt; 3) + (tR[i][2] &lt;&lt; 2) + (tR[i][3] &lt;&lt; 1) + tR[i][4]])));</span><br><span class="line">        &#125;</span><br><span class="line">        return sr.toCharArray();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * p 表置换</span><br><span class="line">     * @param sR char[32]</span><br><span class="line">     * @return char[32]</span><br><span class="line">     */</span><br><span class="line">    private char[] pReplace(char[] sR)&#123;</span><br><span class="line">        char[] pR = new char[32];</span><br><span class="line">        for (int i = 0; i &lt; 32; i++)&#123;</span><br><span class="line">            pR[i] = sR[data.P[i]-1];</span><br><span class="line">        &#125;</span><br><span class="line">        return pR;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     *  终结置换</span><br><span class="line">     * @param R char[64]</span><br><span class="line">     * @return char[64]</span><br><span class="line">     */</span><br><span class="line">    private char[] init_1Replace(char[] R)&#123;</span><br><span class="line">        char[] tR = new char[64];</span><br><span class="line">        for (int i = 0; i &lt; 64; i++)&#123;</span><br><span class="line">            tR[i] = R[data.IP_1[i]-1];</span><br><span class="line">        &#125;</span><br><span class="line">        return tR;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     *  轮置换</span><br><span class="line">     * @param R char[32]</span><br><span class="line">     * @param K char[32]</span><br><span class="line">     * @return char[32]</span><br><span class="line">     */</span><br><span class="line">    public char[] core(char[] R, char[] K)&#123;</span><br><span class="line">        char[] eR = eReplace(R);</span><br><span class="line">        System.out.println(&quot;Etable置换结果---&quot;+new String(eR)+&quot;-----&quot;+util.two2hex(new String(eR)));</span><br><span class="line">        System.out.println(&quot;轮密钥---&quot;+new String(K)+&quot;-----&quot;+util.two2hex(new String(K)));</span><br><span class="line">        char[] xorR = xor(eR,K);</span><br><span class="line">        System.out.println(&quot;xor-1结果---&quot;+new String(xorR)+&quot;-----&quot;+util.two2hex(new String(xorR)));</span><br><span class="line">        char[] sR = sReplace(xorR);</span><br><span class="line">        System.out.println(&quot;Sbox置换结果---&quot;+new String(sR)+&quot;-----&quot;+util.two2hex(new String(sR)));</span><br><span class="line">        char[] pR = pReplace(sR);</span><br><span class="line">        System.out.println(&quot;Ptable置换结果---&quot;+new String(pR)+&quot;-----&quot;+util.two2hex(new String(pR)));</span><br><span class="line">        @SuppressWarnings(&quot;unused&quot;)</span><br><span class="line">		String pp = new String(pR);</span><br><span class="line">        return pR;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public String enCode(char[] M, char[] K)&#123;</span><br><span class="line">    	System.out.println(&quot;#########################&quot;);</span><br><span class="line">    	System.out.println(&quot; =====  === == ==  = =   开始加密&quot;);</span><br><span class="line">    	System.out.println(&quot;比特流为---&quot;+new String(M)+&quot;-----&quot;+util.two2hex(new String(M)));</span><br><span class="line">    	System.out.println(&quot;密钥为---&quot;+new String(K)+&quot;-----&quot;+util.two2hex(new String(K)));</span><br><span class="line">        char[][] L = new char[17][32];</span><br><span class="line">        char[][] R = new char[17][32];</span><br><span class="line">        char[][] key = new char[16][48];</span><br><span class="line">        char[] res = new char[64];</span><br><span class="line">        char[] r = new char[64];</span><br><span class="line">        M = initReplace(M);</span><br><span class="line">        System.out.println(&quot;IP置换结果---&quot;+new String(M)+&quot;-----&quot;+util.two2hex(new String(M)));</span><br><span class="line">        key = getKey(K);</span><br><span class="line">        for (int i = 0; i &lt; 32; i++)&#123;</span><br><span class="line">            L[0][i] = M[i];</span><br><span class="line">            R[0][i] = M[i+32];</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        for (int i = 1; i &lt; 17; i++)&#123;</span><br><span class="line">        	System.out.println(&quot;===================第 &quot;+i+&quot; 轮==================&quot;);</span><br><span class="line">            char[] xorR = xor(L[i-1],core(R[i-1],key[i-1]));</span><br><span class="line">            System.out.println(&quot;xor-2结果&quot;+new String(xorR)+&quot;-----&quot;+util.two2hex(new String(xorR)));</span><br><span class="line">            for (int j = 0; j &lt; 32; j++)&#123;</span><br><span class="line">                L[i][j] = R[i-1][j];</span><br><span class="line">                R[i][j] = xorR[j];</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        for (int i = 0; i &lt; 32; i++)&#123;</span><br><span class="line">            res[i] = R[16][i];</span><br><span class="line">            res[i+32] = L[16][i];</span><br><span class="line">        &#125;</span><br><span class="line">        r = init_1Replace(res);</span><br><span class="line">        String rr = new String(r);</span><br><span class="line">        System.out.println(&quot;终结置换结果---&quot;+new String(rr)+&quot;-----&quot;+util.two2hex(new String(rr)));</span><br><span class="line">        return rr;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    public String deCode(char[] M, char[] K)&#123;</span><br><span class="line">    	System.out.println(&quot;#########################&quot;);</span><br><span class="line">    	System.out.println(&quot; =====  === == ==  = =   开始解密&quot;);</span><br><span class="line">    	System.out.println(&quot;比特流为---&quot;+new String(M)+&quot;-----&quot;+util.two2hex(new String(M)));</span><br><span class="line">    	System.out.println(&quot;密钥为---&quot;+new String(K)+&quot;-----&quot;+util.two2hex(new String(K)));</span><br><span class="line">        char[][] L = new char[17][32];</span><br><span class="line">        char[][] R = new char[17][32];</span><br><span class="line">        char[][] key = new char[16][48];</span><br><span class="line">        char[] res = new char[64];</span><br><span class="line">        char[] r = new char[64];</span><br><span class="line">        M = initReplace(M);</span><br><span class="line">        System.out.println(&quot;IP置换结果---&quot;+new String(M)+&quot;-----&quot;+util.two2hex(new String(M)));</span><br><span class="line">        key = getKey(K);</span><br><span class="line">        for (int i = 0; i &lt; 32; i++)&#123;</span><br><span class="line">            L[0][i] = M[i];</span><br><span class="line">            R[0][i] = M[i+32];</span><br><span class="line">        &#125;</span><br><span class="line">        for (int i = 1; i &lt; 17; i++)&#123;</span><br><span class="line">        	System.out.println(&quot;===================第 &quot;+i+&quot; 轮==================&quot;);</span><br><span class="line">            char[] xorR = xor(L[i-1],core(R[i-1],key[16-i]));</span><br><span class="line">            System.out.println(&quot;xor-2结果&quot;+new String(xorR)+&quot;-----&quot;+util.two2hex(new String(xorR)));</span><br><span class="line">            for (int j = 0; j &lt; 32; j++)&#123;</span><br><span class="line">                L[i][j] = R[i-1][j];</span><br><span class="line">                R[i][j] = xorR[j];</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        for (int i = 0; i &lt; 32; i++)&#123;</span><br><span class="line">            res[i] = R[16][i];</span><br><span class="line">            res[i+32] = L[16][i];</span><br><span class="line">        &#125;</span><br><span class="line">        r = init_1Replace(res);</span><br><span class="line">        String rr = new String(r);</span><br><span class="line">        return rr;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    public String en(String[] mm, char[] kk) &#123;</span><br><span class="line">    	String mi = &quot;&quot;;</span><br><span class="line">		for(int i = 0; i &lt; mm.length; i++)&#123;</span><br><span class="line">			char[] charrr = mm[i].toCharArray();</span><br><span class="line">			mi += enCode(charrr, kk);</span><br><span class="line">		&#125;</span><br><span class="line">		return mi;</span><br><span class="line">	&#125;</span><br><span class="line">    </span><br><span class="line">    public String de(String[] mm, char[] kk) &#123;</span><br><span class="line">    	String mi = &quot;&quot;;</span><br><span class="line">		for(int i = 0; i &lt; mm.length; i++)&#123;</span><br><span class="line">			char[] charrr = mm[i].toCharArray();</span><br><span class="line">			mi += deCode(charrr, kk);</span><br><span class="line">		&#125;</span><br><span class="line">		return mi;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br></pre></td><td class="code"><pre><span class="line">// des算法置换过程需要用到的一些置换表</span><br><span class="line"></span><br><span class="line">package cryptology;</span><br><span class="line"></span><br><span class="line">/**</span><br><span class="line"> * Created by leif on 2016/3/26 0026.</span><br><span class="line"> */</span><br><span class="line">public class data &#123;</span><br><span class="line">        // 声明常量字节数组</span><br><span class="line">	static int length = 0;</span><br><span class="line">	</span><br><span class="line">    public static int getLength() &#123;</span><br><span class="line">		return length;</span><br><span class="line">	&#125;</span><br><span class="line">	public static void setLength(int length) &#123;</span><br><span class="line">		data.length = length;</span><br><span class="line">	&#125;</span><br><span class="line">	/**</span><br><span class="line">     * 初始置换</span><br><span class="line">     */</span><br><span class="line">    static final int[] IP = &#123;</span><br><span class="line">                58, 50, 42, 34, 26, 18, 10, 2, 60, 52, 44, 36, 28, 20, 12, 4, 62, 54,</span><br><span class="line">                46, 38, 30, 22, 14, 6, 64, 56, 48, 40, 32, 24, 16, 8, 57, 49, 41, 33,</span><br><span class="line">                25, 17, 9, 1, 59, 51, 43, 35, 27, 19, 11, 3, 61, 53, 45, 37, 29, 21,</span><br><span class="line">                13, 5, 63, 55, 47, 39, 31, 23, 15, 7</span><br><span class="line">        &#125;; // 64</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     *</span><br><span class="line">     */</span><br><span class="line">    static final int[] IP_1 = &#123;</span><br><span class="line">                40, 8, 48, 16, 56, 24, 64, 32, 39, 7, 47, 15, 55, 23, 63, 31, 38, 6,</span><br><span class="line">                46, 14, 54, 22, 62, 30, 37, 5, 45, 13, 53, 21, 61, 29, 36, 4, 44, 12,</span><br><span class="line">                52, 20, 60, 28, 35, 3, 43, 11, 51, 19, 59, 27, 34, 2, 42, 10, 50, 18,</span><br><span class="line">                58, 26, 33, 1, 41, 9, 49, 17, 57, 25</span><br><span class="line">        &#125;; // 64</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * 密钥置换  1</span><br><span class="line">     */</span><br><span class="line">    static final int[] PC_1 = &#123;</span><br><span class="line">                57, 49, 41, 33, 25, 17, 9, 1, 58, 50, 42, 34, 26, 18, 10, 2, 59, 51,</span><br><span class="line">                43, 35, 27, 19, 11, 3, 60, 52, 44, 36, 63, 55, 47, 39, 31, 23, 15, 7,</span><br><span class="line">                62, 54, 46, 38, 30, 22, 14, 6, 61, 53, 45, 37, 29, 21, 13, 5, 28, 20,</span><br><span class="line">                12, 4</span><br><span class="line">        &#125;; // 56</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     *  密钥置换  2</span><br><span class="line">     */</span><br><span class="line">    static final int[] PC_2 = &#123;</span><br><span class="line">                14, 17, 11, 24, 1, 5, 3, 28, 15, 6, 21, 10, 23, 19, 12, 4, 26, 8, 16,</span><br><span class="line">                7, 27, 20, 13, 2, 41, 52, 31, 37, 47, 55, 30, 40, 51, 45, 33, 48, 44,</span><br><span class="line">                49, 39, 56, 34, 53, 46, 42, 50, 36, 29, 32</span><br><span class="line">        &#125;; // 48</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     *  E表置换（将密钥的右32置换为48）</span><br><span class="line">     */</span><br><span class="line">    static final int[] E = &#123;</span><br><span class="line">                32, 1, 2, 3, 4, 5, 4, 5, 6, 7, 8, 9, 8, 9, 10, 11, 12, 13, 12, 13,</span><br><span class="line">                14, 15, 16, 17, 16, 17, 18, 19, 20, 21, 20, 21, 22, 23, 24, 25, 24,</span><br><span class="line">                25, 26, 27, 28, 29, 28, 29, 30, 31, 32, 1</span><br><span class="line">        &#125;; // 48</span><br><span class="line"></span><br><span class="line">        static final int[] P = &#123;</span><br><span class="line">                16, 7, 20, 21, 29, 12, 28, 17, 1, 15, 23, 26, 5, 18, 31, 10, 2, 8,</span><br><span class="line">                24, 14, 32, 27, 3, 9, 19, 13, 30, 6, 22, 11, 4, 25</span><br><span class="line">        &#125;; // 32</span><br><span class="line">        static final int[][][] S_Box = &#123;</span><br><span class="line">                &#123;</span><br><span class="line">                        &#123; 14, 4, 13, 1, 2, 15, 11, 8, 3, 10, 6, 12, 5, 9, 0, 7 &#125;,</span><br><span class="line">                        &#123; 0, 15, 7, 4, 14, 2, 13, 1, 10, 6, 12, 11, 9, 5, 3, 8 &#125;,</span><br><span class="line">                        &#123; 4, 1, 14, 8, 13, 6, 2, 11, 15, 12, 9, 7, 3, 10, 5, 0 &#125;,</span><br><span class="line">                        &#123; 15, 12, 8, 2, 4, 9, 1, 7, 5, 11, 3, 14, 10, 0, 6, 13 &#125;</span><br><span class="line">                &#125;,</span><br><span class="line">                &#123; // S_Box[1]</span><br><span class="line">                        &#123; 15, 1, 8, 14, 6, 11, 3, 4, 9, 7, 2, 13, 12, 0, 5, 10 &#125;,</span><br><span class="line">                        &#123; 3, 13, 4, 7, 15, 2, 8, 14, 12, 0, 1, 10, 6, 9, 11, 5 &#125;,</span><br><span class="line">                        &#123; 0, 14, 7, 11, 10, 4, 13, 1, 5, 8, 12, 6, 9, 3, 2, 15 &#125;,</span><br><span class="line">                        &#123; 13, 8, 10, 1, 3, 15, 4, 2, 11, 6, 7, 12, 0, 5, 14, 9 &#125;</span><br><span class="line">                &#125;,</span><br><span class="line">                &#123; // S_Box[2]</span><br><span class="line">                        &#123; 10, 0, 9, 14, 6, 3, 15, 5, 1, 13, 12, 7, 11, 4, 2, 8 &#125;,</span><br><span class="line">                        &#123; 13, 7, 0, 9, 3, 4, 6, 10, 2, 8, 5, 14, 12, 11, 15, 1 &#125;,</span><br><span class="line">                        &#123; 13, 6, 4, 9, 8, 15, 3, 0, 11, 1, 2, 12, 5, 10, 14, 7 &#125;,</span><br><span class="line">                        &#123; 1, 10, 13, 0, 6, 9, 8, 7, 4, 15, 14, 3, 11, 5, 2, 12 &#125;</span><br><span class="line">                &#125;,</span><br><span class="line">                &#123; // S_Box[3]</span><br><span class="line">                        &#123; 7, 13, 14, 3, 0, 6, 9, 10, 1, 2, 8, 5, 11, 12, 4, 15 &#125;,</span><br><span class="line">                        &#123; 13, 8, 11, 5, 6, 15, 0, 3, 4, 7, 2, 12, 1, 10, 14, 9 &#125;,</span><br><span class="line">                        &#123; 10, 6, 9, 0, 12, 11, 7, 13, 15, 1, 3, 14, 5, 2, 8, 4 &#125;,</span><br><span class="line">                        &#123; 3, 15, 0, 6, 10, 1, 13, 8, 9, 4, 5, 11, 12, 7, 2, 14 &#125;</span><br><span class="line">                &#125;,</span><br><span class="line">                &#123; // S_Box[4]</span><br><span class="line">                        &#123; 2, 12, 4, 1, 7, 10, 11, 6, 8, 5, 3, 15, 13, 0, 14, 9 &#125;,</span><br><span class="line">                        &#123; 14, 11, 2, 12, 4, 7, 13, 1, 5, 0, 15, 10, 3, 9, 8, 6 &#125;,</span><br><span class="line">                        &#123; 4, 2, 1, 11, 10, 13, 7, 8, 15, 9, 12, 5, 6, 3, 0, 14 &#125;,</span><br><span class="line">                        &#123; 11, 8, 12, 7, 1, 14, 2, 13, 6, 15, 0, 9, 10, 4, 5, 3 &#125;</span><br><span class="line">                &#125;,</span><br><span class="line">                &#123; // S_Box[5]</span><br><span class="line">                        &#123; 12, 1, 10, 15, 9, 2, 6, 8, 0, 13, 3, 4, 14, 7, 5, 11 &#125;,</span><br><span class="line">                        &#123; 10, 15, 4, 2, 7, 12, 9, 5, 6, 1, 13, 14, 0, 11, 3, 8 &#125;,</span><br><span class="line">                        &#123; 9, 14, 15, 5, 2, 8, 12, 3, 7, 0, 4, 10, 1, 13, 11, 6 &#125;,</span><br><span class="line">                        &#123; 4, 3, 2, 12, 9, 5, 15, 10, 11, 14, 1, 7, 6, 0, 8, 13 &#125;</span><br><span class="line">                &#125;,</span><br><span class="line">                &#123; // S_Box[6]</span><br><span class="line">                        &#123; 4, 11, 2, 14, 15, 0, 8, 13, 3, 12, 9, 7, 5, 10, 6, 1 &#125;,</span><br><span class="line">                        &#123; 13, 0, 11, 7, 4, 9, 1, 10, 14, 3, 5, 12, 2, 15, 8, 6 &#125;,</span><br><span class="line">                        &#123; 1, 4, 11, 13, 12, 3, 7, 14, 10, 15, 6, 8, 0, 5, 9, 2 &#125;,</span><br><span class="line">                        &#123; 6, 11, 13, 8, 1, 4, 10, 7, 9, 5, 0, 15, 14, 2, 3, 12 &#125;</span><br><span class="line">                &#125;,</span><br><span class="line">                &#123; // S_Box[7]</span><br><span class="line">                        &#123; 13, 2, 8, 4, 6, 15, 11, 1, 10, 9, 3, 14, 5, 0, 12, 7 &#125;,</span><br><span class="line">                        &#123; 1, 15, 13, 8, 10, 3, 7, 4, 12, 5, 6, 11, 0, 14, 9, 2 &#125;,</span><br><span class="line">                        &#123; 7, 11, 4, 1, 9, 12, 14, 2, 0, 6, 10, 13, 15, 3, 5, 8 &#125;,</span><br><span class="line">                        &#123; 2, 1, 14, 7, 4, 10, 8, 13, 15, 12, 9, 0, 3, 5, 6, 11 &#125;</span><br><span class="line">                &#125; // S_Box[8]</span><br><span class="line">        &#125;;</span><br><span class="line">        static final int[] LeftMove = &#123;</span><br><span class="line">                1, 1, 2, 2, 2, 2, 2, 2, 1, 2, 2, 2, 2, 2, 2, 1</span><br><span class="line">        &#125;; // 左移位置列表</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br></pre></td><td class="code"><pre><span class="line">// 系统里用到的一些公共的功能性函数</span><br><span class="line"></span><br><span class="line">package cryptology;</span><br><span class="line"></span><br><span class="line">import java.util.HashMap;</span><br><span class="line"></span><br><span class="line">/**</span><br><span class="line"> * Created by leif on 2016/6/21.</span><br><span class="line"> */</span><br><span class="line">public class util &#123;</span><br><span class="line">    /**</span><br><span class="line">     *  二进制转十进制</span><br><span class="line">     * @param two 二进制 string</span><br><span class="line">     * @return 十进制 int</span><br><span class="line">     */</span><br><span class="line">    public static int two2ten(String two)&#123;</span><br><span class="line">        String s = two;</span><br><span class="line">        int x = 0;</span><br><span class="line">        int pow = 0;</span><br><span class="line">        for (int i = s.length() - 1; i &gt;= 0; i--) &#123;</span><br><span class="line">            x += Math.pow(2, pow) * (s.charAt(i) == &apos;1&apos; ? 1 : 0);</span><br><span class="line">            pow ++;</span><br><span class="line">        &#125;</span><br><span class="line">        return x;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    /**</span><br><span class="line">     *  二进制转十六进制</span><br><span class="line">     * @param two 二进制 string</span><br><span class="line">     * @return 十六进制 int</span><br><span class="line">     */</span><br><span class="line">    public static String two2hex(String bString)&#123;</span><br><span class="line">    	if (bString == null || bString.equals(&quot;&quot;) || bString.length() % 8 != 0)  </span><br><span class="line">            return null;  </span><br><span class="line">        StringBuffer tmp = new StringBuffer();  </span><br><span class="line">        int iTmp = 0;  </span><br><span class="line">        for (int i = 0; i &lt; bString.length(); i += 4)  </span><br><span class="line">        &#123;  </span><br><span class="line">            iTmp = 0;  </span><br><span class="line">            for (int j = 0; j &lt; 4; j++)  </span><br><span class="line">            &#123;  </span><br><span class="line">                iTmp += Integer.parseInt(bString.substring(i + j, i + j + 1)) &lt;&lt; (4 - j - 1);  </span><br><span class="line">            &#125;  </span><br><span class="line">            tmp.append(Integer.toHexString(iTmp));  </span><br><span class="line">        &#125;  </span><br><span class="line">        return tmp.toString();  </span><br><span class="line">    &#125;  </span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     *  将64位int数组转化为64位char数组</span><br><span class="line">     * @param mm int[64]</span><br><span class="line">     * @return char[64]</span><br><span class="line">     */</span><br><span class="line">    public static char[] int64tochar64(int[] mm)&#123;</span><br><span class="line">        @SuppressWarnings(&quot;unused&quot;)</span><br><span class="line">		char[] g = new char[64];</span><br><span class="line">        String gg = new String();</span><br><span class="line">        for (int i = 0; i &lt; 64; i++)&#123;</span><br><span class="line">            gg += mm[i];</span><br><span class="line">        &#125;</span><br><span class="line">        return gg.toCharArray();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public static HashMap&lt;Integer,char[]&gt; preMI(String mmmmmm)&#123;</span><br><span class="line">    	String lmmmmmm = &quot;&quot;;</span><br><span class="line">    	for(int i = 0; i &lt; mmmmmm.length(); i++)&#123;</span><br><span class="line">    		lmmmmmm += Integer.toBinaryString(Integer.parseInt(mmmmmm.substring(i,i+1)));</span><br><span class="line">    	&#125;</span><br><span class="line">    	HashMap&lt;Integer, char[] &gt; tmmm = new HashMap&lt;&gt;();</span><br><span class="line">    	char mmmmm[] = lmmmmmm.toCharArray();</span><br><span class="line">    	char rm[] = new char[64];</span><br><span class="line">    	int j = 0;</span><br><span class="line">    	for(int i = 0; i &lt; lmmmmmm.length(); i++)&#123;</span><br><span class="line">    		rm[i%64] = mmmmm[i];</span><br><span class="line">    		if (i % 64 == 63) &#123;</span><br><span class="line">				tmmm.put(j, rm);</span><br><span class="line">				j++;</span><br><span class="line">			&#125;</span><br><span class="line">    	&#125;</span><br><span class="line">    	return tmmm;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    /**</span><br><span class="line">     * 明文初始化处理，将每一位转为一个64bit长度的string</span><br><span class="line">     * @param all</span><br><span class="line">     * @return</span><br><span class="line">     */</span><br><span class="line">    public static String[] all2string(String all)  &#123;</span><br><span class="line">		byte byteall[] = all.getBytes();</span><br><span class="line">		String allstring[] = new String[all.length()];</span><br><span class="line">		for(int i = 0; i &lt; byteall.length; i++)&#123;</span><br><span class="line">			allstring[i] =   String.format(&quot;%064d&quot;, Integer.parseInt(Integer.toBinaryString(byteall[i])));</span><br><span class="line">		&#125;</span><br><span class="line">		return allstring;</span><br><span class="line">	&#125;</span><br><span class="line">    </span><br><span class="line">    /**</span><br><span class="line">     * 密文解密预处理，将密文每64bit截取成一个string</span><br><span class="line">     * @param all</span><br><span class="line">     * @return</span><br><span class="line">     */</span><br><span class="line">    public static String[] all222string(String all)  &#123;</span><br><span class="line">		String allstring[] = new String[all.length()/64];</span><br><span class="line">		for(int i = 0; i &lt; allstring.length; i++)&#123;</span><br><span class="line">			allstring[i] =   all.substring(i*64,(i+1)*64);</span><br><span class="line">		&#125;</span><br><span class="line">		return allstring;</span><br><span class="line">	&#125;</span><br><span class="line">    </span><br><span class="line">    /**</span><br><span class="line">     * 将解密结果的byte转为string，还原密文</span><br><span class="line">     * @param all</span><br><span class="line">     * @return</span><br><span class="line">     */</span><br><span class="line">    public static String byte2string(String all)  &#123;</span><br><span class="line">		byte allstring[] = new byte[all.length()/64];</span><br><span class="line">		for(int i = 0; i &lt; allstring.length; i++)&#123;</span><br><span class="line">			allstring[i] =   (byte) two2ten(all.substring(i*64,(i+1)*64).substring(56, 64));</span><br><span class="line">		&#125;</span><br><span class="line">		return new String(allstring);</span><br><span class="line">	&#125;</span><br><span class="line">    </span><br><span class="line">    /**</span><br><span class="line">     * 将任意格式的密钥获取hash值，格式化为char[64]</span><br><span class="line">     * @param k</span><br><span class="line">     * @return</span><br><span class="line">     */</span><br><span class="line">    public static char[] keypre(String k) &#123;</span><br><span class="line">		String ha = String.format(&quot;%08d&quot;, k.hashCode());</span><br><span class="line">		String kk = &quot;&quot;;</span><br><span class="line">		for(int i = 0; i &lt; 8; i++)&#123;</span><br><span class="line">			kk += String.format(&quot;%08d&quot;, Integer.parseInt(Integer.toBinaryString(Integer.parseInt(ha.substring(i, i+1)))));</span><br><span class="line">		&#125;</span><br><span class="line">		return kk.toCharArray();</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
            </div>
          

    
      <footer class="post-footer">
		
		<div class="post-tags">
		  
			<a href="/tags/Java/">Java</a>
		  
			<a href="/tags/code/">code</a>
		  
		</div>
		

        
        
  <nav class="post-nav">
    
      <a class="prev" href="/2016/09/11/网易云信短信验证码验证PHP实现/">
        <i class="iconfont icon-left"></i>
        <span class="prev-text nav-default">网易云信短信验证码验证PHP实现</span>
        <span class="prev-text nav-mobile">Prev</span>
      </a>
    
    
      <a class="next" href="/2016/07/09/rip协议java模拟实现/">
        <span class="next-text nav-default">rip协议Java模拟实现</span>
        <span class="prev-text nav-mobile">Next</span>
        <i class="iconfont icon-right"></i>
      </a>
    
  </nav>

        
  <div class="comments" id="comments">
    
  </div>


      </footer>
    
  </article>

    </div>

      </div>

      <footer id="colophon"><span class="copyright-year">
    
        &copy;
    
        2015 -
    
    2020
    <span class="footer-author">EricLi. 鲁ICP备16001445号.</span>
    <span class="power-by">
        Powered by <a class="hexo-link" href="https://hexo.io/">Hexo</a>
    </span>
</span>

      </footer>

      <div class="back-to-top" id="back-to-top">
        <i class="iconfont icon-up"></i>
      </div>
    </div>
    


    




  
    <script type="text/javascript" src="/lib/jquery/jquery-3.1.1.min.js"></script>
  

  

    <script type="text/javascript" src="/js/src/theme.js?v=1.1"></script>
<script type="text/javascript" src="/js/src/bootstrap.js?v=1.1"></script>

  </body>
</html>
